import{d as K,e as X,i as Y,f as Z,j as r,B as C,c as a,T as h,r as m,g as F,h as ee,k as te,M as ae,l as ie,m as se,u as re,n as oe,a as V,R as ne,o as le,I as ce,p as ue,C as de,G as S,q as j,t as pe,v as he,_ as H,w as me,x as fe,y as u,z as ve,A as Ce,D as xe,E as ze,H as ye}from"./index.a66382f1.js";const ke=K(),ge=ke;var _={},Se=Y.exports;Object.defineProperty(_,"__esModule",{value:!0});var P=_.default=void 0,_e=Se(X()),we=Z,be=(0,_e.default)((0,we.jsx)("path",{d:"M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2zm-8.9-5h7.45c.75 0 1.41-.41 1.75-1.03L21 4.96 19.25 4l-3.7 7H8.53L4.27 2H1v2h2l3.6 7.59-1.35 2.44C4.52 15.37 5.48 17 7 17h12v-2H7l1.1-2zM12 2l4 4-4 4-1.41-1.41L12.17 7H8V5h4.17l-1.59-1.59L12 2z"}),"ShoppingCartCheckoutOutlined");P=_.default=be;function qe({name:s,description:p,sell_price:n}){return r(C,{children:[a(h,{id:"keep-mounted-modal-title",variant:"h5",component:"h2",children:s!=null?s:a("p",{children:s})}),a(h,{id:"keep-mounted-modal-description",sx:{mt:2,fontWeight:100},children:p}),r(h,{id:"keep-mounted-modal-title",variant:"h5",component:"h2",pt:1,pb:1,children:["$",n]})]})}function Be({sizes:s,updateSizes:p}){var x;const[n,d]=m.exports.useState({value:""}),f=c=>{p(c.target.value),d({value:c.target.value})};return r(C,{sx:{minWidth:120},children:[r(h,{sx:{marginBottom:2},id:"keep-mounted-modal-title",variant:"h5",component:"h2",pt:1,children:[a("span",{children:"Stock:"})," ",a("span",{style:{fontWeight:100},children:(x=s==null?void 0:s.find(c=>c.size===n.value))==null?void 0:x.stock})]}),r(F,{fullWidth:!0,children:[a(ee,{id:"demo-simple-select-label",children:"Size"}),a(te,{labelId:"demo-simple-select-label",id:"demo-simple-select",name:"value",value:n.value,label:"size",onChange:f,children:s==null?void 0:s.map((c,z)=>a(ae,{value:c.size,children:c.size},z))})]})]})}const Ie=m.exports.lazy(()=>H(()=>import("./Photos.e6a22f52.js"),["assets/Photos.e6a22f52.js","assets/Photos.e534f286.css","assets/index.a66382f1.js","assets/index.858a1813.css"])),Ae=m.exports.lazy(()=>H(()=>import("./Reviews.b436333b.js"),["assets/Reviews.b436333b.js","assets/index.a66382f1.js","assets/index.858a1813.css"]));function We(){var w,b,q,B,I,A,L,W,D,R,T;const s=ie(),p=se(),n=re(),{user:d,id:f}=oe(),{products:x,loading:c}=V(o=>d?o.apiCart:o.cart),[z,G]=ne.useState({value:""}),e=V(o=>o.products.product),t=x.find(o=>{var v;return((v=o.idProduct)==null?void 0:v.toString())===p.id}),i={idUser:d?f:null,idProduct:e.id,image:(w=e==null?void 0:e.details)!=null&&w.images?e.details.images[0].image:void 0,name:e.name,color:(q=(b=e==null?void 0:e.details)==null?void 0:b.color)==null?void 0:q.color,size:(B=e.details)==null?void 0:B.sizes,sizeCart:d?void 0:((I=e.details)==null?void 0:I.sizes)&&e.details.sizes[((L=(A=e.details)==null?void 0:A.sizes)==null?void 0:L.length)-1],price:e.sell_price,quantity:1},M=d?((D=t==null?void 0:t.sizeCart)==null?void 0:D.stock)&&t.quantity&&t.sizeCart.stock-t.quantity:((W=i==null?void 0:i.sizeCart)==null?void 0:W.stock)&&(t==null?void 0:t.quantity)&&i.sizeCart.stock-t.quantity,{data:k,isLoading:U}=le(p.id),N=()=>{k!==void 0&&n(me(k))},Q=()=>{n(fe())};m.exports.useEffect(()=>{N()},[k,e.id]),m.exports.useEffect(()=>Q(),[]),m.exports.useEffect(()=>{window.scrollTo(0,0)},[]);const J=async o=>{var v,O,E,$;if(o.preventDefault(),!d)t?(((v=i==null?void 0:i.sizeCart)==null?void 0:v.stock)&&t.quantity&&i.sizeCart.stock-t.quantity)===0?u.fire({title:"Wait!",icon:"error",text:"you already have all stock available",showConfirmButton:!0}):(n(ve({method:"increase",id:e.id?e.id:0,sizes:{}})),Ce.success(a("b",{children:"Correctly updated amount!"}))):(n(xe(i)),u.fire({icon:"success",text:"Product added successfully",showConfirmButton:!0}));else if(t){const l=((O=t==null?void 0:t.sizeCart)==null?void 0:O.stock)&&t.quantity&&t.sizeCart.stock-t.quantity;if(l===0)u.fire({title:"Wait!",icon:"error",text:"you already have all stock available",showConfirmButton:!0});else{let y;u.fire({title:"Wait! that products is already on your cart, we will add this",html:`<p>Current Available Stock: ${l}</p><p>Current Selected Size: ${(E=t.sizeCart)==null?void 0:E.size}</p>`,input:"number",inputAttributes:{autocapitalize:"off",max:`${l}`},showCancelButton:!0,confirmButtonText:"Update",showLoaderOnConfirm:!0,preConfirm:g=>{y=i.quantity&&i.quantity+Number(g)},allowOutsideClick:()=>!u.isLoading()}).then(async g=>{g.isConfirmed&&(await n(ze({idUser:f,idProduct:i.idProduct,quantity:y})),u.fire({icon:"success",text:"Amount updated successfully",showConfirmButton:!0}))})}}else if(z.value!==""){const l=($=i==null?void 0:i.size)==null?void 0:$.find(y=>y.size===z.value);(l==null?void 0:l.stock)===0?u.fire({text:"Can't add this products cause there is not more stock available",icon:"warning"}):(i.size&&await n(ye({id:f,products:i,id_size:l==null?void 0:l.id,token:d.token})),u.fire({icon:"success",text:"Product added successfully",showConfirmButton:!0}))}else u.fire({title:"We need more information",icon:"error",text:"please select one size"})};return r(C,{minHeight:"60vh",children:[a(ce,{containerStyle:{position:"absolute",top:"50%",left:"30%"}}),(U||c)&&a(ue,{sx:{color:"secondary",zIndex:o=>o.zIndex.drawer+1},open:!0,children:a(de,{color:"inherit",size:200})}),r(ge,{maxWidth:"xl",children:[r(S,{container:!0,spacing:1,children:[a(S,{item:!0,xs:6,children:e.details!==void 0&&a(Ie,{details:e.details})}),r(S,{item:!0,xs:6,children:[a(qe,{name:e==null?void 0:e.name,description:e==null?void 0:e.description,sell_price:e==null?void 0:e.sell_price}),t&&r(C,{children:[r(h,{variant:"h5",component:"h2",pt:1,children:["Current Selected Size: ",(R=t==null?void 0:t.sizeCart)==null?void 0:R.size]}),r(h,{variant:"h5",component:"h2",pt:1,children:["Current Avalable Stock: ",M]})]}),!t&&a(Be,{sizes:(T=e==null?void 0:e.details)==null?void 0:T.sizes,updateSizes:o=>G({value:o})}),r(C,{mt:2,sx:{width:500,maxWidth:"100%"},children:[a(j,{variant:"contained",size:"large",fullWidth:!0,sx:{width:"100%",marginBottom:2},onClick:J,startIcon:a(pe,{}),children:"ADD TO CART"}),a(j,{variant:"outlined",size:"large",color:"secondary",fullWidth:!0,onClick:()=>s(he.cart),sx:{width:"100%",marginBottom:2},startIcon:a(P,{}),children:"GO TO CART"})]})]})]}),a(Ae,{})]})]})}export{We as default};
