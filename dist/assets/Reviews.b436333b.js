import{aw as T,c as e,a7 as j,n as R,F as h,j as a,N as A,G as n,T as u,ax as C,ay as I,az as M,y as g,e as D,i as E,f as z,R as P,r as x,m as B,a5 as $,q as y,ab as k,B as w,aA as F,aj as S,a8 as O,C as W,as as G,ac as L,ae as Y,ad as V,at as H}from"./index.a66382f1.js";const N=T.injectEndpoints({endpoints:r=>({getReviewsUser:r.query({query:t=>({url:`/reviews/user/${t}`}),providesTags:["Reviews"]}),getReviewsProduct:r.query({query:t=>({url:`/reviews/product/${t}`}),providesTags:["Reviews"]}),createReview:r.mutation({query:t=>({url:"/reviews",method:"POST",body:t}),invalidatesTags:["Reviews"]}),deleteReview:r.mutation({query:t=>({url:"/reviews",method:"DELETE",body:t}),invalidatesTags:["Reviews"]})})}),{useGetReviewsUserQuery:ce,useGetReviewsProductQuery:Q,useCreateReviewMutation:J,useDeleteReviewMutation:K}=N;function X({width:r,height:t}){return e(j,{sx:{width:{width:r},height:{height:t}}})}function Z({id_user:r,id_product:t,review:m,date:d,rate:i,User:o}){const[v,f]=K(),c=R(),s=()=>{r&&t&&g.fire({title:"Delete?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#5d3a00",cancelButtonColor:"#d33",confirmButtonText:"Yes!"}).then(p=>{p.isConfirmed&&v({id_user:r,id_product:t}).then(()=>{g.fire({title:"Deleted",text:"Your review has been deleted.",confirmButtonColor:"#5d3a00",icon:"success"})}).catch(()=>{g.fire({icon:"error",title:"Oops...",text:"Something went wrong!",confirmButtonColor:"#5d3a00"})})})};return e(h,{children:a(A,{sx:{p:2,maxWidth:500,minHeight:200,flexGrow:1},children:[a(n,{container:!0,spacing:2,alignItems:"center",children:[e(n,{item:!0,children:e(X,{width:100,height:100})}),e(n,{item:!0,sm:!0,container:!0,children:e(n,{item:!0,xs:!0,container:!0,direction:"column",spacing:2,children:a(n,{item:!0,xs:!0,children:[a(u,{gutterBottom:!0,variant:"subtitle1",component:"div",children:[o==null?void 0:o.first_name," ",o==null?void 0:o.last_name]}),a(u,{gutterBottom:!0,variant:"body2",component:"div",children:["@",o==null?void 0:o.username]}),e(C,{name:"read-only",value:i,readOnly:!0}),e(u,{variant:"body2",gutterBottom:!0,children:m}),e(u,{variant:"body2",color:"text.secondary",children:d})]})})})]}),c.id===r?e(n,{item:!0,display:"flex",justifyContent:"end",children:e(I,{"aria-label":"delete",size:"small",color:"secondary",children:e(M,{onClick:s})})}):e(h,{})]})})}var b={},U=E.exports;Object.defineProperty(b,"__esModule",{value:!0});var q=b.default=void 0,ee=U(D()),te=z,re=(0,ee.default)((0,te.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");q=b.default=re;const ie=L({rate:Y().min(0).max(5).required("First Name is required"),review:V().min(10).max(200).required("Message is required")}),ae={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90%",maxWidth:600,bgcolor:"background.paper",border:"none",boxShadow:24,borderRadius:4,justifyContent:"center",p:4};function ne(){const[r,t]=P.useState(!1),m=()=>t(!0),d=()=>t(!1),i=R(),[o,v]=x.exports.useState(!1),f=B(),[c,{data:s,isLoading:p,isSuccess:oe,error:se,isError:le}]=J(),l=$({initialValues:{id_product:parseInt(f.id),id_user:i.id,review:"",rate:0},validationSchema:ie,onSubmit:_=>{v(!0),c(_),l.resetForm(),d()}});return a(h,{children:[e(y,{onClick:m,color:"secondary",variant:"outlined",size:"small",startIcon:e(q,{}),children:"add"}),e(k,{open:r,onClose:d,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:a(w,{sx:ae,children:[a(F,{component:"main",maxWidth:"sm",children:[e(w,{display:"flex",justifyContent:"flex-end",children:e(y,{color:"secondary",onClick:d,children:"close"})}),e(S,{}),a(w,{sx:{marginTop:1,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e(u,{component:"h1",variant:"h5",children:"Review this product"}),a(w,{component:"form",noValidate:!0,onSubmit:l.handleSubmit,sx:{mt:3},children:[a(n,{container:!0,spacing:2,children:[a(n,{item:!0,xs:12,children:[e(u,{component:"legend",children:"Your Rating"}),e(C,{size:"large",id:"rate",name:"rate",value:l.values.rate,onChange:l.handleChange})]}),e(n,{item:!0,xs:12,children:e(O,{required:!0,fullWidth:!0,id:"review",name:"review",label:"Review",type:"text",multiline:!0,minRows:5,maxRows:10,value:l.values.review,onChange:l.handleChange,error:l.touched.review&&Boolean(l.errors.review),helperText:l.touched.review&&l.errors.review})}),e(n,{item:!0,xs:12})]}),e(y,{disabled:o,type:"submit",fullWidth:!0,variant:"contained",color:"secondary",sx:{mt:3,mb:2},children:p?e(W,{size:20,color:"secondary"}):"review"})]})]})]}),e(G,{sx:{mt:5}})]})})]})}function ue(){const r=R(),{id:t}=B(),[m,d]=x.exports.useState(!1),{data:i,error:o,isSuccess:v,isLoading:f}=Q(parseInt(t));x.exports.useEffect(()=>{r.user?d(!0):h},[r]),x.exports.useEffect(()=>{Array.isArray(i)?i==null||i.forEach(s=>{s.id_user===r.id&&d(!1)}):h},[i]);let c;return o&&(c=e("h1",{children:"Upps"})),f&&(c=e(H,{size:60})),v&&i.length&&(c=i==null?void 0:i.map((s,p)=>e(n,{item:!0,xs:12,sm:6,xl:6,wrap:"wrap",children:e(Z,{id_user:s.id_user,id_product:s.id_product,review:s.review,date:s.date,rate:s.rate,User:s.User})},p))),a(h,{children:[e(S,{}),a(n,{container:!0,spacing:2,alignItems:"center",mt:6,mb:6,children:[e(n,{item:!0,xs:12,sm:"auto",maxWidth:"fit-content",children:a(u,{variant:"h5",width:"100%",gutterBottom:!0,children:["Reviews( ",(i==null?void 0:i.length)||0,")"]})}),e(n,{item:!0,xs:12,sm:9,textAlign:"left",children:m&&e(ne,{})})]}),e(n,{container:!0,spacing:2,children:c})]})}export{ue as default};
